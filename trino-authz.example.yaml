# Example Trino Authorization Configuration
# This file configures row-level security filters for Trino tables

rowFilters:
  # Define filters for the postgres.public.projects table
  trino_table_postgres_public_projects:
    - action: only_public
      expression: "is_public = TRUE"
    - action: small_projects
      expression: "size = 'small'"

  # Define filters for the postgres.public.users table
  trino_table_postgres_public_users:
    - action: view_active
      expression: "status = 'active'"
    - action: view_own_data
      expression: "user_id = current_user"

  # Define filters for the analytics.sales.transactions table
  trino_table_analytics_sales_transactions:
    - action: current_year_only
      expression: "YEAR(transaction_date) = YEAR(CURRENT_DATE)"
    - action: region_us
      expression: "region = 'US'"
    - action: high_value
      expression: "amount > 1000"

# Note:
# - The resource name follows the format: trino_table_{catalog}_{schema}_{table}
# - The 'action' corresponds to the action in your Permit policy
# - The 'expression' is the SQL WHERE clause that will be applied to queries
# - Multiple filters can be defined per table
# - If a user has permission for multiple actions, all corresponding expressions will be returned
